# WasmEdge 

ì¼ë‹¨, ìœˆë„ìš°ì¦ˆì—ì„œì„œëŠ” ì„¤ì¹˜ê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Ubuntuì—ì„œ ì„¤ì¹˜í•˜ê³  í…ŒìŠ¤íŠ¸í–ˆìŠµë‹ˆë‹¤. 

RustëŠ” WebAssembly ìƒíƒœê³„ì˜ 'ì¼ê¸‰ ì‹œë¯¼' í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. WebAssemblyì— ëŒ€í•œ ëª¨ë“  WasmEdge í™•ì¥ì€ ê°œë°œìë¥¼ ìœ„í•œ Rust APIì™€ í•¨ê»˜ ì œê³µë©ë‹ˆë‹¤. ì´ ì¥ì—ì„œëŠ” Rust ì• í”Œë¦¬ì¼€ì´ì…˜ì„ WebAssemblyë¡œ ì»´íŒŒì¼í•˜ê³  WasmEdge ëŸ°íƒ€ì„ì—ì„œ ì‹¤í–‰í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.


ì´ ê¸€ì˜ ë‚´ìš©ì€ [Write a WebAssembly Application](https://wasmedge.org/book/en/write_wasm/rust.html)ì„ ì°¸ê³ í•˜ì—¬ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.


## ì¤€ë¹„ë¬¼ 
ì‹œì‘í•˜ë ¤ë©´ Rustì™€ WasmEdgeë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤. Rust íˆ´ì²´ì¸ì˜ wasm32-wasi targetë„ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

```shell
rustup target add wasm32-wasi
```

> wasm32-wasi íƒ€ê²Ÿì€ ìƒˆë¡­ê³  ì—¬ì „íˆ(2019ë…„ 4ì›” í˜„ì¬) ì‹¤í—˜ì ì¸ íƒ€ê²Ÿì…ë‹ˆë‹¤. ì´ íŒŒì¼ì˜ ì •ì˜ëŠ” ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì¡°ì •ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë„ˆë¬´ ë§ì´ ì˜ì¡´í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.
> wasi ëŒ€ìƒì€ WebAssembly íŒŒì¼ì´ ìƒí˜¸ ìš´ìš©í•  ìˆ˜ ìˆëŠ” í‘œì¤€í™”ëœ syscall ì„¸íŠ¸ë¥¼ ì •ì˜í•˜ê¸° ìœ„í•œ ì œì•ˆì…ë‹ˆë‹¤. ì´ syscall ì„¸íŠ¸ëŠ” íŒŒì¼ ì‹œìŠ¤í…œ ì•¡ì„¸ìŠ¤, ë„¤íŠ¸ì›Œí¬ ì•¡ì„¸ìŠ¤ ë“±ê³¼ ê°™ì€ ê¸°ë³¸ ê¸°ëŠ¥ìœ¼ë¡œ WebAssembly ë°”ì´ë„ˆë¦¬ë¥¼ ê°•í™”í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤.
> ì—¬ê¸°ì„œ Rust ëŒ€ìƒ ì •ì˜ëŠ” ëª‡ ê°€ì§€ ë©´ì—ì„œ í¥ë¯¸ë¡­ìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì´ ëŒ€ìƒê³¼ í•¨ê»˜ ë‘ ê°€ì§€ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ì œê³µí•˜ê³ ì í•©ë‹ˆë‹¤.    
> * ì²«ì§¸, ìš°ë¦¬ëŠ” ëŒ€ìƒì˜ Rust ì‚¬ìš©ì´ ê°€ëŠ¥í•œ í•œ ë²ˆê±°ë¡­ì§€ ì•Šê¸°ë¥¼ ì›í•©ë‹ˆë‹¤. ì´ìƒì ìœ¼ë¡œëŠ” ë¡œì»¬ wasm32-wasi íˆ´ì²´ì¸ì„ êµ¬ì„±í•˜ê³  ì„¤ì¹˜í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
> * ë‘˜ì§¸, LLVMì˜ ìƒˆë¡œìš´ wasm ë°±ì—”ë“œ ë° LLDì˜ wasm ì§€ì›ì˜ ì£¼ìš” ì‚¬ìš© ì‚¬ë¡€ ì¤‘ í•˜ë‚˜ëŠ” ëª¨ë“  ì»´íŒŒì¼ëœ ì–¸ì–´ê°€ ë‹¤ë¥¸ ì–¸ì–´ì™€ ìƒí˜¸ ìš´ìš©ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë”°ë¼ì„œ wasm32-wasi ëŒ€ìƒì€ ì‹¤í–‰ ê°€ëŠ¥í•œ C í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ sysroot ê³µí†µ ì •ì˜ê°€ ìˆëŠ” ì²« ë²ˆì§¸ ëŒ€ìƒì´ë¯€ë¡œ wasm32-unknown-unknownìœ¼ë¡œ ì»´íŒŒì¼ë  ë•Œ Rust ë° C/C++ ì½”ë“œê°€ ìƒí˜¸ ìš´ìš©ë˜ê¸°ë¥¼ ì›í•©ë‹ˆë‹¤.
> [Module rustc_target::spec::wasm32_wasi](https://doc.rust-lang.org/beta/nightly-rustc/rustc_target/spec/wasm32_wasi/index.html) ì°¸ì¡°.


## í”„ë¡œê·¸ë¨ ì‘ì„±

ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•œë‹¤. 

```shell
cargo new hello
```
main.rsì— ë‹¤ìŒì„ ì¶”ê°€í•œë‹¤.

**src/main.rs**    
```rust
use std::env;

fn main() {
  println!("hello");
  for argument in env::args().skip(1) {
    println!("{}", argument);
  }
}
```

### WASM bytecode ë¹Œë“œ 

```shell
cargo build --target wasm32-wasi
```

### í”„ë¡œê·¸ë¨ ì‹¤í–‰ 
ì»¤ë§¨ë“œë¼ì¸ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œë‹¤.
```shell
cargo build --target wasm32-wasi
```



## ê°„ë‹¨í•œ í•¨ìˆ˜ 
ë‹¤ìŒì„ ì‹¤í–‰í•˜ì—¬ ìƒˆë¡œìš´ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•œë‹¤. 
```shell
cargo new func
```

lib.rsì— ë‹¤ìŒì„ ì¶”ê°€í•œë‹¤.

**src/lib.rs**    
```rust
#[no_mangle]
pub fn add(a: i32, b: i32) -> i32 {
  return a + b;
}
```

### WASM bytecode ë¹Œë“œ 

Cargo.tomlì— ë‹¤ìŒì„ ì¶”ê°€í•œë‹¤.
```toml
[lib]
name = "add"
path = "src/lib.rs"
crate-type =["cdylib"]
```
ë¹Œë“œí•œë‹¤. 
```shell
cargo build --target wasm32-wasi
```

ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±ëœë‹¤. 
```shell
ğŸ“‚project_root
  ğŸ“‚func
    ğŸ“‚target
      ğŸ“‚wasm32-wasi
        ğŸ“‚debug
          ğŸ“„add.wasm
```



### í”„ë¡œê·¸ë¨ ì‹¤í–‰ 
ì»¤ë§¨ë“œë¼ì¸ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•œë‹¤.
```shell
wasmedge --reactor target/wasm32-wasi/debug/add.wasm add 2 2
4
```


**ë¬¼ë¡  ëŒ€ë¶€ë¶„ì˜ ê²½ìš° CLI ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹  í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  í˜¸ì¶œ ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•˜ê³  ë°˜í™˜ ê°’ì„ ìˆ˜ì‹ í•˜ë ¤ë©´ WasmEdgeì˜ ì–¸ì–´ SDKë¥¼ ì‚¬ìš©í•´ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.** 

[WasmEdgeëŠ” WasmEdge Rust SDK](https://wasmedge.org/book/en/sdk/rust.html) ë¥¼ í†µí•´ Rust ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì‚½ì…í•˜ëŠ” ê²ƒì„ ì§€ì›í•©ë‹ˆë‹¤. WasmEdge Rust SDKë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œëŠ” ë‹¤ë¥¸ ë¬¸ì„œì—ì„œ ì •ë¦¬í•©ë‹ˆë‹¤. 






